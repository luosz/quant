(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8177,        227]
NotebookOptionsPosition[      7932,        214]
NotebookOutlinePosition[      8278,        229]
CellTagsIndexPosition[      8235,        226]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"std", "[", 
    RowBox[{"symbol_", ",", 
     RowBox[{"off_:", "0"}], ",", 
     RowBox[{"days_:", "7"}], ",", 
     RowBox[{"bet_:", "50"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r", ",", "p1", ",", "p2", ",", "ohlcv", ",", "t", ",", "l", ",", "n", 
       ",", "d", ",", "num", ",", "num2", ",", "diff"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"FinancialData", "[", 
        RowBox[{"symbol", ",", "\"\<Range\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"Mean", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ohlcv", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Last", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"FinancialData", "[", 
           RowBox[{"symbol", ",", "\"\<OHLCV\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"DateList", "@", 
              RowBox[{"DayRound", "[", 
               RowBox[{
                RowBox[{"Today", "-", 
                 RowBox[{"Quantity", "[", 
                  RowBox[{"off", ",", "\"\<Days\>\""}], "]"}]}], ",", 
                "\"\<BusinessDay\>\"", ",", "\"\<Previous\>\""}], "]"}]}], 
             "}"}]}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ohlcv", "!=", 
          RowBox[{"Missing", "[", "\"\<NotAvailable\>\"", "]"}]}], ",", 
         RowBox[{"ohlcv", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"FinancialData", "[", "symbol", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DateList", "@", 
           RowBox[{"DayRound", "[", 
            RowBox[{
             RowBox[{"Today", "-", 
              RowBox[{"Quantity", "[", 
               RowBox[{
                RowBox[{"days", "+", "off"}], ",", "\"\<Days\>\""}], "]"}]}], 
             ",", "\"\<BusinessDay\>\"", ",", "\"\<Next\>\""}], "]"}]}], ",", 
          RowBox[{"DateList", "@", 
           RowBox[{"DayRound", "[", 
            RowBox[{
             RowBox[{"Today", "-", 
              RowBox[{"Quantity", "[", 
               RowBox[{"off", ",", "\"\<Days\>\""}], "]"}]}], ",", 
             "\"\<BusinessDay\>\"", ",", "\"\<Previous\>\""}], "]"}]}]}], 
         "}"}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", "#"}], "&"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Last", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"FinancialData", "[", 
          RowBox[{"symbol", ",", "t"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "l", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "n"}], "]"}], "*", 
        RowBox[{"StandardDeviation", "[", "l", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{"bet", "/", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"num2", "=", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{"bet", "/", "diff"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diff", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"Differences", "[", "l", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"d", ",", 
        RowBox[{"d", "/", "p2"}], ",", "diff", ",", 
        RowBox[{"diff", "/", "p2"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"num", ",", 
            RowBox[{"num", "*", "p2"}]}], "}"}], ",", "Bold", ",", "Larger", 
          ",", 
          RowBox[{"Background", "\[Rule]", "LightYellow"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p1", ",", 
            RowBox[{"p1", "-", "d"}], ",", 
            RowBox[{"p1", "+", "d"}]}], "}"}], ",", "Bold", ",", "Larger", 
          ",", 
          RowBox[{"Background", "\[Rule]", "LightPurple"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p2", ",", 
            RowBox[{"p2", "-", "d"}], ",", 
            RowBox[{"p2", "+", "d"}]}], "}"}], ",", "Bold", ",", "Larger", 
          ",", 
          RowBox[{"Background", "\[Rule]", "LightPurple"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"num2", ",", 
            RowBox[{"num2", "*", "p2"}]}], "}"}], ",", "Bold", ",", "Larger", 
          ",", 
          RowBox[{"Background", "\[Rule]", "LightYellow"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p1", ",", 
            RowBox[{"p1", "-", "diff"}], ",", 
            RowBox[{"p1", "+", "diff"}]}], "}"}], ",", "Bold", ",", "Larger", 
          ",", 
          RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p2", ",", 
            RowBox[{"p2", "-", "diff"}], ",", 
            RowBox[{"p2", "+", "diff"}]}], "}"}], ",", "Bold", ",", "Larger", 
          ",", 
          RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ohlcv", "!=", 
           RowBox[{"Missing", "[", "\"\<NotAvailable\>\"", "]"}]}], ",", 
          "ohlcv", ",", "r"}], "]"}], ",", "t", ",", "l"}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chart", "[", 
    RowBox[{"symbol_", ",", 
     RowBox[{"off_:", "0"}], ",", 
     RowBox[{"days_:", "28"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DateList", "@", 
          RowBox[{"DayRound", "[", 
           RowBox[{
            RowBox[{"Today", "-", 
             RowBox[{"Quantity", "[", 
              RowBox[{
               RowBox[{"days", "+", "off"}], ",", "\"\<Days\>\""}], "]"}]}], 
            ",", "\"\<BusinessDay\>\"", ",", "\"\<Next\>\""}], "]"}]}], ",", 
         RowBox[{"DateList", "@", 
          RowBox[{"DayRound", "[", 
           RowBox[{
            RowBox[{"Today", "-", 
             RowBox[{"Quantity", "[", 
              RowBox[{"off", ",", "\"\<Days\>\""}], "]"}]}], ",", 
            "\"\<BusinessDay\>\"", ",", "\"\<Previous\>\""}], "]"}]}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TradingChart", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"symbol", ",", "t"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Volume\>\"", ",", "\"\<AroonOscillator\>\"", ",", 
          "\"\<MoneyFlowIndex\>\"", ",", 
          "\"\<MovingAverageConvergenceDivergence\>\""}], "}"}]}], "]"}]}]}], 
    "]"}]}], ";"}]}], "Input"]
},
WindowSize->{1288, 714},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7370, 192, 432, "Input"]
}
]
*)

(* End of internal cache information *)
