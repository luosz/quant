(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11935,        260]
NotebookOptionsPosition[     11689,        247]
NotebookOutlinePosition[     12035,        262]
CellTagsIndexPosition[     11992,        259]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"std", "[", 
    RowBox[{"symbol_", ",", 
     RowBox[{"off_:", "0"}], ",", 
     RowBox[{"days_:", "7"}], ",", 
     RowBox[{"bet_:", "50"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r", ",", "p", ",", "p2", ",", "ohlcv", ",", "t", ",", "l", ",", "n", 
       ",", "d", ",", "num"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"FinancialData", "[", 
        RowBox[{"symbol", ",", "\"\<Range\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Mean", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ohlcv", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Last", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"FinancialData", "[", 
           RowBox[{"symbol", ",", "\"\<OHLCV\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"DateList", "@", 
              RowBox[{"DayRound", "[", 
               RowBox[{
                RowBox[{"Today", "-", 
                 RowBox[{"Quantity", "[", 
                  RowBox[{"off", ",", "\"\<Days\>\""}], "]"}]}], ",", 
                "\"\<BusinessDay\>\"", ",", "\"\<Previous\>\""}], "]"}]}], 
             "}"}]}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ohlcv", "!=", 
          RowBox[{"Missing", "[", "\"\<NotAvailable\>\"", "]"}]}], ",", 
         RowBox[{"ohlcv", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"FinancialData", "[", "symbol", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DateList", "@", 
           RowBox[{"DayRound", "[", 
            RowBox[{
             RowBox[{"Today", "-", 
              RowBox[{"Quantity", "[", 
               RowBox[{
                RowBox[{"days", "+", "off"}], ",", "\"\<Days\>\""}], "]"}]}], 
             ",", "\"\<BusinessDay\>\"", ",", "\"\<Next\>\""}], "]"}]}], ",", 
          RowBox[{"DateList", "@", 
           RowBox[{"DayRound", "[", 
            RowBox[{
             RowBox[{"Today", "-", 
              RowBox[{"Quantity", "[", 
               RowBox[{"off", ",", "\"\<Days\>\""}], "]"}]}], ",", 
             "\"\<BusinessDay\>\"", ",", "\"\<Previous\>\""}], "]"}]}]}], 
         "}"}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", "#"}], "&"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Last", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"FinancialData", "[", 
          RowBox[{"symbol", ",", "t"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "l", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "n"}], "]"}], "*", 
        RowBox[{"StandardDeviation", "[", "l", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{"bet", "/", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"d", ",", 
        RowBox[{"d", "/", "p"}], ",", 
        RowBox[{"num", "*", "p"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", "num", "}"}], ",", "Bold", ",", "Larger", ",", 
          RowBox[{"Background", "\[Rule]", "LightOrange"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"p", "-", "d"}], ",", 
            RowBox[{"p", "+", "d"}]}], "}"}], ",", "Bold", ",", "Larger", ",", 
          RowBox[{"Background", "\[Rule]", "LightMagenta"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p2", ",", 
            RowBox[{"p2", "-", "d"}], ",", 
            RowBox[{"p2", "+", "d"}]}], "}"}], ",", "Bold", ",", "Larger", 
          ",", 
          RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ohlcv", "!=", 
           RowBox[{"Missing", "[", "\"\<NotAvailable\>\"", "]"}]}], ",", 
          "ohlcv", ",", "r"}], "]"}], ",", "t", ",", "l"}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chart", "[", 
    RowBox[{"symbol_", ",", 
     RowBox[{"off_:", "0"}], ",", 
     RowBox[{"days_:", "28"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DateList", "@", 
          RowBox[{"DayRound", "[", 
           RowBox[{
            RowBox[{"Today", "-", 
             RowBox[{"Quantity", "[", 
              RowBox[{
               RowBox[{"days", "+", "off"}], ",", "\"\<Days\>\""}], "]"}]}], 
            ",", "\"\<BusinessDay\>\"", ",", "\"\<Next\>\""}], "]"}]}], ",", 
         RowBox[{"DateList", "@", 
          RowBox[{"DayRound", "[", 
           RowBox[{
            RowBox[{"Today", "-", 
             RowBox[{"Quantity", "[", 
              RowBox[{"off", ",", "\"\<Days\>\""}], "]"}]}], ",", 
            "\"\<BusinessDay\>\"", ",", "\"\<Previous\>\""}], "]"}]}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TradingChart", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"symbol", ",", "t"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Volume\>\"", ",", "\"\<AroonOscillator\>\"", ",", 
          "\"\<MoneyFlowIndex\>\"", ",", 
          "\"\<MovingAverageConvergenceDivergence\>\""}], "}"}]}], "]"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6351910479871106`*^9, 3.635191051551489*^9}, {
   3.6351923157958813`*^9, 3.6351923164453144`*^9}, {3.6351924217895927`*^9, 
   3.6351924219967303`*^9}, {3.635192480515769*^9, 3.63519251844307*^9}, {
   3.635192563116872*^9, 3.6351925639214087`*^9}, {3.6351928683635073`*^9, 
   3.635193121704514*^9}, {3.6351931574363513`*^9, 3.635193294225605*^9}, {
   3.635193346973794*^9, 3.6351934135667596`*^9}, {3.635193510943722*^9, 
   3.6351935299994335`*^9}, {3.635193596050497*^9, 3.635193624217288*^9}, {
   3.635193654673604*^9, 3.6351936860405307`*^9}, {3.6351968424721823`*^9, 
   3.6351968429253316`*^9}, {3.6352705609432545`*^9, 3.635270564844858*^9}, {
   3.6352713435946636`*^9, 3.6352715181319895`*^9}, {3.635271678931777*^9, 
   3.635271785158407*^9}, {3.6352722346476727`*^9, 3.635272235319565*^9}, {
   3.635272341491054*^9, 3.6352723617208056`*^9}, {3.63527245329769*^9, 
   3.63527246411075*^9}, {3.635272812404437*^9, 3.6352728480782356`*^9}, {
   3.6352729429726343`*^9, 3.635272976114745*^9}, {3.63527306780286*^9, 
   3.6352730692716727`*^9}, {3.6352731016952333`*^9, 3.635273104492244*^9}, {
   3.635273194831222*^9, 3.635273268913724*^9}, {3.635273309040798*^9, 
   3.6352733777162156`*^9}, {3.6352735190819273`*^9, 
   3.6352735383016973`*^9}, {3.6353638602113056`*^9, 3.6353638619926243`*^9}, 
   3.635363934418285*^9, 3.635363968888832*^9, {3.6353657081744967`*^9, 
   3.6353657301131535`*^9}, {3.6353657784125533`*^9, 3.635365802866957*^9}, 
   3.635366026303952*^9, {3.6353660823013325`*^9, 3.63536608710354*^9}, {
   3.6353662008224535`*^9, 3.635366216110658*^9}, {3.6353663480317726`*^9, 
   3.635366353000815*^9}, {3.6353665662410355`*^9, 3.635366567929164*^9}, 
   3.635366601967886*^9, {3.6353691642087297`*^9, 3.6353691644358807`*^9}, {
   3.6354235684558644`*^9, 3.6354235953635187`*^9}, {3.6354237625441437`*^9, 
   3.6354237774198956`*^9}, {3.6354443529891367`*^9, 3.635444460188696*^9}, {
   3.635444493251768*^9, 3.635444497533626*^9}, {3.635444533017314*^9, 
   3.6354445670900593`*^9}, {3.6354446693523245`*^9, 3.6354446900831647`*^9}, 
   3.635444726270322*^9, {3.635444763943471*^9, 3.635444821499893*^9}, {
   3.6354448724599113`*^9, 3.635444881884202*^9}, {3.6354449285443506`*^9, 
   3.635444933523675*^9}, {3.635444971186817*^9, 3.6354449739656734`*^9}, {
   3.63544503865886*^9, 3.6354450402539253`*^9}, {3.6354450918593736`*^9, 
   3.6354450942909975`*^9}, {3.6354462935425673`*^9, 3.6354462941289577`*^9}, 
   3.63544649511613*^9, {3.6354465964948063`*^9, 3.6354466027820034`*^9}, {
   3.6354470749778357`*^9, 3.635447080910796*^9}, {3.6354471290910497`*^9, 
   3.6354471444512596`*^9}, {3.635447494375765*^9, 3.6354475177207136`*^9}, {
   3.635447662887577*^9, 3.6354476859829955`*^9}, 3.635448283322754*^9, 
   3.635448988100625*^9, {3.635449125351248*^9, 3.6354491269593215`*^9}, {
   3.635449945674324*^9, 3.635449954256053*^9}, {3.6354520911345725`*^9, 
   3.6354521096356735`*^9}, {3.6354532416835318`*^9, 3.63545324471494*^9}, {
   3.6354532915299177`*^9, 3.6354533517830153`*^9}, {3.6354534405858135`*^9, 
   3.635453455570953*^9}, {3.6354535267934074`*^9, 3.6354535705457077`*^9}, {
   3.635453614891773*^9, 3.6354536303300924`*^9}, {3.6354537008806195`*^9, 
   3.635453726475709*^9}, 3.6354545204276676`*^9, 3.635454554991988*^9, {
   3.6354559043812304`*^9, 3.635455934242182*^9}, {3.635455971462874*^9, 
   3.6354559871824274`*^9}, 3.63545603070036*^9, {3.635456373685606*^9, 
   3.635456407808385*^9}, {3.6354568488194904`*^9, 3.635456867609033*^9}, {
   3.6354569843999567`*^9, 3.6354570049010553`*^9}, 3.635457076326647*^9, {
   3.6354579777140484`*^9, 3.635457985059952*^9}, 3.635458069712504*^9, {
   3.6355113261242123`*^9, 3.6355114641245317`*^9}, 3.635511536124733*^9, {
   3.6355117401408443`*^9, 3.635511747968992*^9}, {3.6355117981097407`*^9, 
   3.635511816062928*^9}, {3.6355242907002916`*^9, 3.6355242909233084`*^9}, 
   3.635524387119857*^9, {3.6355251460458064`*^9, 3.6355252189366245`*^9}, {
   3.6355252722805085`*^9, 3.635525306530588*^9}, {3.6355253425462766`*^9, 
   3.6355253534213033`*^9}, {3.6355254214214897`*^9, 3.635525425062153*^9}, {
   3.6355254677809687`*^9, 3.63552550431231*^9}, {3.635525539187392*^9, 
   3.6355255705285068`*^9}, {3.63552566347469*^9, 3.635525686515057*^9}, {
   3.635525783645629*^9, 3.6355258163904705`*^9}, {3.6355258468792763`*^9, 
   3.635525932310208*^9}, {3.6355259808840103`*^9, 3.6355260147569714`*^9}, {
   3.6355261295675917`*^9, 3.635526159761357*^9}, 3.6355262543167906`*^9, {
   3.6355263316572504`*^9, 3.635526367880346*^9}, {3.6355264365792947`*^9, 
   3.6355264399064794`*^9}, {3.635526480548793*^9, 3.6355264880762243`*^9}, {
   3.635526545758606*^9, 3.6355265657587643`*^9}, {3.6355266188008413`*^9, 
   3.6355266571610365`*^9}, 3.6355274929284334`*^9, {3.635527532100401*^9, 
   3.635527620449519*^9}, {3.6355277039243307`*^9, 3.6355277255565977`*^9}, {
   3.6355277903992968`*^9, 3.6355278093193617`*^9}, {3.6355286373192406`*^9, 
   3.6355286502758894`*^9}, {3.635529144491895*^9, 3.6355292115169*^9}, {
   3.6355292526732264`*^9, 3.635529281313922*^9}}]
},
WindowSize->{1288, 714},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 11127, 225, 352, "Input"]
}
]
*)

(* End of internal cache information *)
