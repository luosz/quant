(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      6353,        184]
NotebookOptionsPosition[      6108,        171]
NotebookOutlinePosition[      6454,        186]
CellTagsIndexPosition[      6411,        183]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"std", "[", 
    RowBox[{"symbol_", ",", 
     RowBox[{"off_:", "0"}], ",", 
     RowBox[{"days_:", "7"}], ",", 
     RowBox[{"bet_:", "70"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ohlcv", ",", "p", ",", "p2", ",", "t", ",", "l", ",", "n", ",", "d", 
       ",", "num"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ohlcv", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Last", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"FinancialData", "[", 
           RowBox[{"symbol", ",", "\"\<OHLCV\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"DateList", "@", 
              RowBox[{"DayRound", "[", 
               RowBox[{
                RowBox[{"Today", "-", 
                 RowBox[{"Quantity", "[", 
                  RowBox[{"off", ",", "\"\<Days\>\""}], "]"}]}], ",", 
                "\"\<BusinessDay\>\"", ",", "\"\<Previous\>\""}], "]"}]}], 
             "}"}]}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"ohlcv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", "3"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"ohlcv", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", "4"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DateList", "@", 
           RowBox[{"DayRound", "[", 
            RowBox[{
             RowBox[{"Today", "-", 
              RowBox[{"Quantity", "[", 
               RowBox[{
                RowBox[{"days", "+", "off"}], ",", "\"\<Days\>\""}], "]"}]}], 
             ",", "\"\<BusinessDay\>\"", ",", "\"\<Next\>\""}], "]"}]}], ",", 
          RowBox[{"DateList", "@", 
           RowBox[{"DayRound", "[", 
            RowBox[{
             RowBox[{"Today", "-", 
              RowBox[{"Quantity", "[", 
               RowBox[{"off", ",", "\"\<Days\>\""}], "]"}]}], ",", 
             "\"\<BusinessDay\>\"", ",", "\"\<Previous\>\""}], "]"}]}]}], 
         "}"}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", "#"}], "&"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Last", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"FinancialData", "[", 
          RowBox[{"symbol", ",", "t"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "l", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "n"}], "]"}], "*", 
        RowBox[{"StandardDeviation", "[", "l", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{"bet", "/", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"d", ",", 
        RowBox[{"d", "/", "p"}], ",", 
        RowBox[{"num", "*", "p"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", "num", "}"}], ",", "Bold", ",", "Larger", ",", 
          RowBox[{"Background", "\[Rule]", "LightYellow"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"p", "-", "d"}], ",", 
            RowBox[{"p", "+", "d"}]}], "}"}], ",", "Bold", ",", "Larger", ",", 
          RowBox[{"Background", "->", "LightBlue"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p2", ",", 
            RowBox[{"p2", "-", "d"}], ",", 
            RowBox[{"p2", "+", "d"}]}], "}"}], ",", "Bold", ",", "Larger", 
          ",", 
          RowBox[{"Background", "\[Rule]", "LightRed"}]}], "]"}], ",", 
        "ohlcv", ",", "t", ",", "l"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chart", "[", 
    RowBox[{"symbol_", ",", 
     RowBox[{"off_:", "0"}], ",", 
     RowBox[{"days_:", "28"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DateList", "@", 
          RowBox[{"DayRound", "[", 
           RowBox[{
            RowBox[{"Today", "-", 
             RowBox[{"Quantity", "[", 
              RowBox[{
               RowBox[{"days", "+", "off"}], ",", "\"\<Days\>\""}], "]"}]}], 
            ",", "\"\<BusinessDay\>\"", ",", "\"\<Next\>\""}], "]"}]}], ",", 
         RowBox[{"DateList", "@", 
          RowBox[{"DayRound", "[", 
           RowBox[{
            RowBox[{"Today", "-", 
             RowBox[{"Quantity", "[", 
              RowBox[{"off", ",", "\"\<Days\>\""}], "]"}]}], ",", 
            "\"\<BusinessDay\>\"", ",", "\"\<Previous\>\""}], "]"}]}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TradingChart", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"symbol", ",", "t"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Volume\>\"", ",", "\"\<Aroon\>\"", ",", 
          "\"\<MoneyFlowIndex\>\""}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input"]
},
WindowSize->{1288, 714},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5546, 149, 332, "Input"]
}
]
*)

(* End of internal cache information *)
